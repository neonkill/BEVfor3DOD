# @package _global_
defaults:
  - override /model: det/MV_agg4_d16_base
  - override /data: det/nuscenes_det_our
  # - override /loss: center_loss
  # - override /metrics: visibility_metrics

experiment:
  name: MV_agg4_d16_base #! our model, dataset/ topcrop bevaug/ 1/4, 112D
  # uuid: ''

loader:
  batch_size: 2       # mini batch size per 1 GPU
  num_workers: 8
  prefetch_factor: 8
  # sampler: None

optimizer:
  dual_lr: True
  bb_keywords: ['pretrained_convnext', 'layer64', 'layergap']
  depth_keywords: ['depth_layers', 'reduce_depth', 'depth_head']

  lr: 2e-3
  bb_mult: 2
  depth_lr: 1e-4

scheduler:
  name: onecycle
  div_factor: 10           # starts at lr / 10
  pct_start: 0.3           # reaches lr at 30% of total steps
  final_div_factor: 10     # ends at lr / 10 / 10
  total_steps: ${trainer.max_steps}
  cycle_momentum: False


trainer:
  max_steps: 123060
  gpus: 4
  num_sanity_val_steps: -1
  val_check_interval: 1.0
  check_val_every_n_epoch: 1
  # self.eval_interval = eval_interval #! 
  # self.batch_size_per_device = batch_size_per_device #!


