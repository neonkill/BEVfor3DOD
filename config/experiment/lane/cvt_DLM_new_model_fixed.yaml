# @package _global_
defaults:
  - override /model: twoCLS_PE_q25_model_cvt_sameLM
  - override /data: original_nuscenes

  - override /loss: lane_loss
  - override /metrics: lane_metrics

experiment:
  name: cvt_DLM_new_model_fixed

loader:
  batch_size: 4       # mini batch size per 1 GPU
  num_workers: 8
  prefetch_factor: 8

optimizer:
  dual_lr: False
  lr: 4e-3

scheduler:
  name: onecycle
  div_factor: 10           # starts at lr / 10
  pct_start: 0.3           # reaches lr at 30% of total steps
  final_div_factor: 10     # ends at lr / 10 / 10
  total_steps: ${trainer.max_steps}
  cycle_momentum: False

trainer:
  max_steps: 61530
  gpus: 4

# model:
#   outputs:
#     bev: [0, 1]
#     center: [1, 2]